/**
 * 路由
 * @authors yutent (yutent@doui.cc)
 * @date    2015-10-01 19:11:19
 *
 */
"use strict";


class Router{

    constructor(){
        
    }

    /**
     * [init 启动路由]
     */
    init(){
   
        try{
            let App = require(APPS + Request.app)

            if(App){
                if(Request.path.length < 1)
                    Request.path.push('index')

                var act = Request.path.shift()

                if(App.prototype[act]){
                    let _app = new App(Request.app)
                    return _app[act].apply(_app, Request.path).catch(err => Response.error(dojs.debug ? (err.stack || err) : err))
                }else{
                    throw new Error(`Action[${act}] not found`)
                }
            }
            throw new Error(`Module[${Request.app}] not found`)
        }catch(err){
            Response.error(dojs.debug ? (err.stack || err) : err, 500)
        }
        
    }


}


module.exports = Router